# OpenLiteSpeed Virtual Host Configuration
# Place this in your OpenLiteSpeed Admin Console under Virtual Hosts

docRoot                   /path/to/hlqh/frontend/dist
vhDomain                  yourdomain.com
vhAliases                 www.yourdomain.com
adminEmails               admin@yourdomain.com
enableGzip                Yes

errorlog /usr/local/lsws/logs/$VH_NAME_error.log {
  useServer               0
  logLevel                ERROR
  rollingSize             10M
}

accesslog /usr/local/lsws/logs/$VH_NAME_access.log {
  useServer               0
  logFormat               "%h %l %u %t \"%r\" %>s %b"
  logHeaders              5
  rollingSize             10M
  keepDays                10  
  compressArchive         1
}

index  {
  useServer               0
  indexFiles              index.html
}

scripthandler  {
  add                     lsphp81 php
}

# Proxy for API routes
context /api/ {
  type                    proxy
  uri                     http://127.0.0.1:5000/api/
  extraHeaders            X-Forwarded-Proto $scheme
                         X-Forwarded-For $remote_addr
}

# Handle React Router - all non-API routes go to index.html
context / {
  type                    NULL
  location                /path/to/hlqh/frontend/dist/
  allowBrowse             1
  
  rewrite  {
    enable                1
    autoLoadHtaccess      1
  }
}

# Serve static assets with cache headers
context /static/ {
  type                    NULL
  location                /path/to/hlqh/frontend/dist/static/
  allowBrowse             1
  expiresByType           text/css=A31536000, application/javascript=A31536000, image/*=A31536000
}